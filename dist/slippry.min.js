(function($){"use strict";var e;e={slippryWrapper:'<div class="slippry_box" />',slideWrapper:'<div class="slide_box" />',boxClass:'slippry_list',elements:'li',activeClass:'active',useControls:true,usePager:true,prevText:'Previous',nextText:'Next',transition:'fade',transTime:800,fillerClass:'filler',adaptHeight:true,randomStart:false,loop:true,captions:'overlay',initSingle:false};$.fn.slippry=function(c){var d,el,refresh,prepareFiller,setFillerProportions,init,goToSlide,initPager,initControls,initCaptions,updatePager,doTransition,updateSlide;el=this;if(el.length===0){return this}if(el.length>1){el.each(function(){$(this).slippry(c)});return this}d={};d.vars={};setFillerProportions=function(a){var b,height,ratio,p_top;b=a.width();height=a.height();ratio=b/height;p_top=1/ratio*100+'%';$('.'+d.settings.fillerClass,d.vars.slideWrapper).css({paddingTop:p_top})};prepareFiller=function(){if($('.'+d.settings.fillerClass,d.vars.slideWrapper).length===0){d.vars.slideWrapper.append($('<div class="'+d.settings.fillerClass+'" />'))}if(d.settings.adaptHeight===true){setFillerProportions($('.'+d.settings.activeClass,el))}else{var a,$highest,height,count,loop;a=$(d.settings.elements,el);height=0;loop=0;count=a.length;$(a).each(function(){if($(this).height()>height){$highest=$(this);height=$highest.height()}loop=loop+1;if(loop===count){if($highest===undefined){$highest=$($(a)[0])}setFillerProportions($highest)}})}};updatePager=function(){if(d.settings.usePager){$('.pager li',d.vars.slippryWrapper).removeClass('active');$($('.pager li',d.vars.slippryWrapper)[d.vars.active.index()]).addClass(d.settings.activeClass)}};updateSlide=function(){$(d.settings.elements,el).removeClass(d.settings.activeClass);d.vars.active.addClass(d.settings.activeClass);prepareFiller();updatePager();if(d.settings.captions!==false){$('.caption',d.vars.slippryWrapper).text(d.vars.active.attr('title'))}if(d.settings.onSlideAfter!==undefined){d.settings.onSlideAfter.call(d.vars.active)}};doTransition=function(){if(d.settings.onSlideBefore!==undefined){d.settings.onSlideBefore.call(d.vars.active)}if(d.settings.transition!==false){if(d.settings.transition==='fade'){d.vars.old.addClass('animating').fadeOut(d.settings.transTime,function(){});d.vars.active.fadeIn(d.settings.transTime,function(){updateSlide()})}}else{updateSlide()}};goToSlide=function(a){var b,count,current;b=$(d.settings.elements,el);count=b.length;current=$('.'+d.settings.activeClass,el).index();if(a==='prev'){if(current>0){a=current-1}else if(d.settings.loop){a=count-1}}else if(a==='next'){if(current<count-1){a=current+1}else if(d.settings.loop){a=0}}if((a!=='prev')&&(a!=='next')){d.vars.old=d.vars.active;d.vars.active=$($(d.settings.elements,el)[a]);doTransition()}};initPager=function(){if(d.settings.usePager){var a,loop,pager;a=$(d.settings.elements,el).length;pager=$('<ul class="pager" />');for(loop=0;loop<a;loop=loop+1){pager.append($('<li />').append($('<a href="#'+loop+'"></a>')))}d.vars.slippryWrapper.append(pager);$('.pager a').click(function(){goToSlide(this.hash.split('#')[1]);return false});updatePager()}};initControls=function(){if(d.settings.useControls){d.vars.slideWrapper.append($('<ul class="controls" />').append('<li class="slip_prev"><a href="#prev">'+d.settings.prevText+'</a></li>').append('<li class="slip_next"><a href="#next">'+d.settings.nextText+'</a></li>'));$('.controls a').click(function(){goToSlide(this.hash.split('#')[1]);return false})}};initCaptions=function(){if(d.settings.captions!==false){if(d.settings.captions==='overlay'){d.vars.slideWrapper.append('<div class="caption_wrap"><div class="caption"></div></div>')}else if(d.settings.captions==='below'){d.vars.slippryWrapper.append('<div class="caption" />')}$('.caption',d.vars.slippryWrapper).text(d.vars.active.attr('title'))}};refresh=function(){prepareFiller()};init=function(){var a;d.settings=$.extend({},e,c);if($('.'+d.settings.activeClass,el).index()===-1){if(d.settings.randomStart){a=Math.round(Math.random()*($(d.settings.elements,el).length-1))}else{a=0}$($(d.settings.elements,el)[a]).addClass(d.settings.activeClass);d.vars.active=$($(d.settings.elements,el)[a])}else{d.vars.active=$('.'+d.settings.activeClass,el)}el.addClass(d.settings.boxClass).wrap(d.settings.slippryWrapper).wrap(d.settings.slideWrapper);d.vars.slideWrapper=el.parent();d.vars.slippryWrapper=d.vars.slideWrapper.parent();initControls();initPager();initCaptions();refresh()};this.reset=function(){console.log('reset')};init();return this}}(jQuery));